<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="{{ description }}" />
    <meta name="view-transition" content="same-origin">
    <meta name="generator" content="{{ eleventy.generator }}">

    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ page.url }}" />
    <meta property="og:image" content="https://koddsson.com/img/079a3c3546a8794a43ba155b1f1c2a6e-576w.jpeg" />
    <meta property="og:logo" content="/favicon.ico" />

    <link rel="icon" href="/favicon.ico" />

    <title>{{ title }}</title>
    <meta property="og:title" content="{{ title }}" />

    <link rel="stylesheet" href="/css/open-props.min.css">
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/prism-vs.css">
    <link rel="stylesheet" href="/css/index.css">

    <script type="importmap">
      {
        "imports": {
          "web-vitals": "/assets/web-vitals.js"
        }
      }
    </script>
    <script type="module">
      import "/js/toot-embed-element.js";
    </script>
    <script type="module" defer>
      import {onLCP, onCLS, onINP, onFCP, onTTFB} from 'web-vitals';

      const endpoint = 'https://vitals.koddsson.workers.dev/';

      function sendToAnalytics(metric) {
        const body = JSON.stringify(metric);

        // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.
        (navigator.sendBeacon && navigator.sendBeacon(endpoint, body)) ||
          fetch(endpoint, {body, method: 'POST', keepalive: true});
      }

      onCLS(sendToAnalytics);
      onLCP(sendToAnalytics);
      onINP(sendToAnalytics);
      onFCP(sendToAnalytics);
      onTTFB(sendToAnalytics);
    </script>
  </head>
  <body>
    <div class="desktop">
      <div class="window">
        <div class="title-bar">
          <div class="title-bar__icon">
            <img src="/favicon.ico" alt="" width="16" height="16">
          </div>
          <div class="title-bar__text">{{ title }}</div>
          <div class="title-bar__controls">
            <button class="title-bar__btn" aria-label="Minimize">_</button>
            <button class="title-bar__btn" aria-label="Maximize">&#9633;</button>
            <button class="title-bar__btn title-bar__btn--close" aria-label="Close">&#10005;</button>
          </div>
        </div>

        <nav class="menu-bar" aria-label="Main navigation">
          <a href="/" class="menu-bar__item">Home</a>
          <a href="/posts/" class="menu-bar__item">Posts</a>
          <a href="/notes/" class="menu-bar__item">Notes</a>
          <a href="/images/" class="menu-bar__item">Images</a>
          <a href="/reading-list/" class="menu-bar__item">Reading</a>
        </nav>

        <div class="window__content">
          <header>
            <h1>{{ title }}</h1>
            {% if date %}<time datetime="{{ date | date: '%Y-%m-%d' }}">{{ date | date: '%B %d, %Y' }}</time>{% endif %}
          </header>

          <main>{{ content }}</main>
        </div>

        <div class="status-bar">
          <div class="status-bar__section">
            <a href="https://github.com/koddsson">GitHub</a>
            <a href="https://x.com/koddsson">Twitter</a>
            <a href="https://read.cv/koddsson">ReadCV</a>
            <a href="https://linkedin.com/in/koddsson">LinkedIn</a>
          </div>
          <div class="status-bar__section status-bar__section--right">
            &copy; Kristjan Oddsson
          </div>
        </div>
      </div>
    </div>

    <div class="taskbar">
      <a href="/" class="start-button">
        <span class="start-button__flag">&#9776;</span>
        <span>Start</span>
      </a>
      <div class="taskbar__tray">
        <span class="taskbar__clock" id="taskbar-clock"></span>
      </div>
    </div>

    <script>
      function updateClock() {
        var el = document.getElementById('taskbar-clock');
        if (el) {
          var now = new Date();
          var h = now.getHours();
          var m = now.getMinutes();
          var ampm = h >= 12 ? 'PM' : 'AM';
          h = h % 12 || 12;
          el.textContent = h + ':' + (m < 10 ? '0' : '') + m + ' ' + ampm;
        }
      }
      updateClock();
      setInterval(updateClock, 30000);
    </script>
  </body>
</html>
